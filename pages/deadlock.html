<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deadlock Simulator | Memory Management</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- MD3 Styles -->
    <link rel="stylesheet" href="../css/base.css">`n    <link rel="stylesheet" href="../css/components.css">`n    <link rel="stylesheet" href="../css/layout.css">`n    <link rel="stylesheet" href="../css/pages.css">

    <style>
        .page-header {
            background-color: var(--md-surface-container);
            padding: 20px 24px;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--md-outline-variant);
        }

        .page-header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .page-title-group {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .page-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #EF5350, #C62828);
            border-radius: var(--md-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .page-icon i {
            font-size: 24px;
            color: white;
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px 48px;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 24px;
        }

        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        .sidebar {
            position: sticky;
            top: 80px;
            height: fit-content;
        }

        .section-title {
            font-size: var(--md-title-medium);
            font-weight: 500;
            color: var(--md-on-surface);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title i {
            color: var(--md-primary);
        }

        /* Graph Canvas */
        .graph-canvas {
            background-color: var(--md-surface-container-high);
            border-radius: var(--md-radius-lg);
            min-height: 500px;
            padding: 24px;
            position: relative;
            border: 2px dashed var(--md-outline-variant);
        }

        .graph-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 400px;
            color: var(--md-on-surface-variant);
        }

        .graph-empty i {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* Process Node */
        .process-node {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
            color: white;
            position: absolute;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .process-node:hover {
            transform: scale(1.15);
        }

        /* Resource Node */
        .resource-node {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            color: white;
            position: absolute;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .resource-node:hover {
            transform: scale(1.15);
        }

        /* Deadlock animation */
        .deadlock-detected {
            animation: shake 0.5s ease-in-out infinite;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }
        }

        /* Legend */
        .legend-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 24px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background-color: var(--md-surface-container-high);
            border-radius: var(--md-radius-sm);
        }

        .legend-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .legend-icon i {
            color: white;
        }

        .legend-info {
            flex: 1;
        }

        .legend-title {
            font-size: var(--md-body-medium);
            font-weight: 500;
            color: var(--md-on-surface);
        }

        .legend-desc {
            font-size: var(--md-label-medium);
            color: var(--md-on-surface-variant);
        }

        /* Deadlock Info Panel */
        .deadlock-info {
            margin-top: 24px;
        }

        .deadlock-alert {
            padding: 16px;
            border-radius: var(--md-radius-md);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .deadlock-alert.danger {
            background-color: rgba(239, 83, 80, 0.1);
            border-left: 4px solid #EF5350;
        }

        .deadlock-alert.safe {
            background-color: rgba(129, 199, 132, 0.1);
            border-left: 4px solid var(--md-success);
        }

        .deadlock-alert i {
            font-size: 24px;
        }

        .deadlock-alert.danger i {
            color: #EF5350;
        }

        .deadlock-alert.safe i {
            color: var(--md-success);
        }
    </style>
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-content">
            <a href="../index.html" class="btn btn-text">
                <i class="fas fa-arrow-left"></i>
                <span>Dashboard</span>
            </a>
            <div style="text-align: center;">
                <div class="navbar-title">Deadlock Detection Simulator</div>
                <div class="navbar-subtitle">Resource Allocation Graph & Circular Wait</div>
            </div>
            <button onclick="openInfoModal()" class="btn btn-text">
                <i class="fas fa-info-circle"></i>
            </button>
        </div>
    </nav>

    <!-- Page Header -->
    <div class="page-header">
        <div class="page-header-content">
            <div class="page-title-group">
                <div class="page-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <div>
                    <h1 style="font-size: var(--md-headline-medium); color: var(--md-on-surface);">Deadlock Detection
                    </h1>
                    <p style="font-size: var(--md-body-medium); color: var(--md-on-surface-variant);">Resource
                        Allocation Graph & Banker's Algorithm</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div id="info-modal" class="modal-overlay">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <div class="modal-icon" style="background-color: rgba(239, 83, 80, 0.2); color: #EF5350;">
                    <i class="fas fa-lock"></i>
                </div>
                <h3 class="modal-title">Tentang Deadlock</h3>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 16px;"><strong>Deadlock</strong> adalah kondisi di mana 2 atau lebih proses
                    saling menunggu resource yang sedang dipegang oleh proses lain.</p>

                <div style="padding: 16px; background: var(--md-surface-container-high); border-radius: 8px;">
                    <strong style="color: #EF5350; display: block; margin-bottom: 12px;">4 Kondisi Deadlock
                        (Coffman):</strong>
                    <ol style="padding-left: 20px; color: var(--md-on-surface-variant); font-size: 14px;">
                        <li style="margin-bottom: 6px;"><strong>Mutual Exclusion:</strong> Resource hanya bisa digunakan
                            1 proses</li>
                        <li style="margin-bottom: 6px;"><strong>Hold and Wait:</strong> Proses memegang resource sambil
                            menunggu yang lain</li>
                        <li style="margin-bottom: 6px;"><strong>No Preemption:</strong> Resource tidak bisa dipaksa
                            diambil</li>
                        <li><strong>Circular Wait:</strong> Ada cycle dalam waiting chain</li>
                    </ol>
                </div>
            </div>
            <div class="modal-actions">
                <button onclick="closeInfoModal()" class="btn btn-filled"
                    style="background: linear-gradient(135deg, #EF5350, #C62828);">Mengerti</button>
            </div>
        </div>
    </div>

    <!-- Notification Modal -->
    <div id="custom-notification" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <div id="notification-icon" class="modal-icon"
                    style="background-color: rgba(239, 83, 80, 0.2); color: #EF5350;">
                    <i class="fas fa-info-circle"></i>
                </div>
                <h3 class="modal-title">Notifikasi</h3>
            </div>
            <div class="modal-body">
                <p id="notification-message"></p>
            </div>
            <div class="modal-actions">
                <button onclick="hideNotification()" class="btn btn-filled"
                    style="background: linear-gradient(135deg, #EF5350, #C62828);">OK</button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-container">
        <div class="main-layout">
            <!-- Sidebar Controls -->
            <aside class="sidebar">
                <div class="card">
                    <h3 class="section-title"><i class="fas fa-sliders-h"></i> Kontrol Simulasi</h3>

                    <div class="input-group">
                        <label class="input-label"><i class="fas fa-clipboard-list"></i> Pilih Scenario</label>
                        <select id="scenario" class="input-field">
                            <option value="no-deadlock">No Deadlock (Safe State)</option>
                            <option value="simple-deadlock">Simple Deadlock (2 Proses)</option>
                            <option value="circular-deadlock">Circular Deadlock (3 Proses)</option>
                            <option value="complex-deadlock">Complex Deadlock (4 Proses)</option>
                        </select>
                    </div>

                    <button onclick="runScenario()" class="btn btn-filled"
                        style="width: 100%; margin-bottom: 8px; background: linear-gradient(135deg, #EF5350, #C62828);">
                        <i class="fas fa-play"></i>
                        Run Scenario
                    </button>

                    <button onclick="resetSimulation()" class="btn btn-outlined" style="width: 100%;">
                        <i class="fas fa-redo"></i>
                        Reset
                    </button>

                    <!-- Stats -->
                    <div style="margin-top: 24px; padding-top: 20px; border-top: 1px solid var(--md-outline-variant);">
                        <h4
                            style="font-size: var(--md-label-large); color: var(--md-on-surface-variant); margin-bottom: 12px;">
                            Status</h4>
                        <div class="stats-item">
                            <span class="stats-label">Total Processes</span>
                            <span id="total-processes" class="stats-value primary">0</span>
                        </div>
                        <div class="stats-item">
                            <span class="stats-label">Total Resources</span>
                            <span id="total-resources" class="stats-value primary">0</span>
                        </div>
                        <div class="stats-item">
                            <span class="stats-label">Deadlock Status</span>
                            <span id="deadlock-status" class="stats-value success">Safe</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Graph Visualization -->
            <section>
                <div class="card">
                    <h3 class="section-title"><i class="fas fa-project-diagram"></i> Resource Allocation Graph</h3>

                    <div id="graph-canvas" class="graph-canvas">
                        <div class="graph-empty">
                            <i class="fas fa-play-circle"></i>
                            <p>Pilih scenario dan klik "Run Scenario" untuk memulai simulasi</p>
                        </div>
                    </div>

                    <!-- Legend -->
                    <div class="legend-grid">
                        <div class="legend-item">
                            <div class="legend-icon" style="background-color: #64B5F6; border-radius: 50%;">
                                <i class="fas fa-circle"></i>
                            </div>
                            <div class="legend-info">
                                <div class="legend-title">Process</div>
                                <div class="legend-desc">Proses yang berjalan</div>
                            </div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-icon" style="background-color: #81C784;">
                                <i class="fas fa-square"></i>
                            </div>
                            <div class="legend-info">
                                <div class="legend-title">Resource</div>
                                <div class="legend-desc">Resource yang tersedia</div>
                            </div>
                        </div>
                        <div class="legend-item">
                            <div style="display: flex; align-items: center; gap: 4px;">
                                <div style="width: 20px; height: 20px; background: #64B5F6; border-radius: 50%;"></div>
                                <i class="fas fa-arrow-right" style="color: var(--md-on-surface-variant);"></i>
                                <div style="width: 20px; height: 20px; background: #81C784; border-radius: 4px;"></div>
                            </div>
                            <div class="legend-info">
                                <div class="legend-title">Request Edge</div>
                                <div class="legend-desc">Proses minta resource</div>
                            </div>
                        </div>
                        <div class="legend-item">
                            <div style="display: flex; align-items: center; gap: 4px;">
                                <div style="width: 20px; height: 20px; background: #81C784; border-radius: 4px;"></div>
                                <i class="fas fa-arrow-right" style="color: var(--md-on-surface-variant);"></i>
                                <div style="width: 20px; height: 20px; background: #64B5F6; border-radius: 50%;"></div>
                            </div>
                            <div class="legend-info">
                                <div class="legend-title">Assignment Edge</div>
                                <div class="legend-desc">Resource assigned</div>
                            </div>
                        </div>
                    </div>

                    <!-- Deadlock Info -->
                    <div id="deadlock-info" class="deadlock-info"></div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>Memory Management Simulator Â© 2025</p>
    </footer>

    <!-- JavaScript -->
    <script src="../js/pages/deadlock.js"></script>

</body>

</html>
